# LOD1-2道路モデル自動生成ツール <!-- OSSの対象物の名称を記載ください。分かりやすさを重視し、できるだけ日本語で命名ください。英語名称の場合は日本語説明を（）書きで併記ください。 -->

<!--
![概要](./img/tutorial_001.png)
 -->
 <!-- OSSの対象物のスクリーンショット（画面表示がない場合にはイメージ画像）を貼り付けください -->

## 1. 概要 <!-- 本リポジトリでOSS化しているソフトウェア・ライブラリについて1文で説明を記載ください -->

本リポジトリでは、Project PLATEAUの令和5年度の調査業務の一部であるDT23-001「まちづくりのDXの推進に向けた3D都市モデルの標準仕様の拡張及びデータ整備の効率化等に関する調査業務」について、その成果物である「LOD1-2道路モデル自動生成ツール」のソースコードを公開しています。

「LOD1-2道路モデル自動生成ツール」は、道路縁シェープファイルからLOD1道路モデルの作成を行うためのツールと、LOD1道路CityGMLファイルと航空写真からLOD2道路モデルの作成を行うためのツールを含みます。

## 2. 「まちづくりのDXの推進に向けた3D都市モデルの標準仕様の拡張及びデータ整備の効率化等に関する調査業務」について <!-- 「」内にユースケース名称を記載ください。本文は以下のサンプルを参考に記載ください。URLはアクセンチュアにて設定しますので、サンプルそのままでOKです。 -->

「まちづくりのDXの推進に向けた3D都市モデルの標準仕様の拡張及びデータ整備の効率化等に関する調査業務」では、令和4年度の建築物LOD2自動生成ツール開発成果等を踏まえ、更なる3D都市モデルの自動生成技術の開発を実施し、都市モデル自動生成ツールの改修・拡充を行いました。本ツールは、都市モデル自動生成ツール拡充の成果となります。 \
本ツールの詳細については[技術検証レポート](https://www.mlit.go.jp/plateau/file/libraries/doc/plateau_tech_doc_0030_ver01.pdf)を参照してください。

## 3. 利用手順 <!-- 下記の通り、GitHub Pagesへリンクを記載ください。URLはアクセンチュアにて設定しますので、サンプルそのままでOKです。 -->

本ツールの構築手順及び利用手順については[利用チュートリアル](https://r5-plateau-acn.github.io/SolarPotential/)を参照してください。

## 4. システム概要 <!-- OSS化対象のシステムが有する機能を記載ください。 -->

### 【LOD1道路モデル自動生成ツール】

#### ①LOD1道路モデル生成機能

- 道路縁と道路施設シェープファイルを使用して、LOD1道路モデルのシェープファイルを作成します。
- 作成したLOD1道路モデルに幾何形状エラーが発生していないかを確認し、エラーが発生している場合はCSVファイルにエラー情報を出力します。

#### ②CityGML変換機能

- LOD1道路モデルのシェープファイルを、CityGMLファイルに変換します。

### 【LOD2道路モデル自動生成ツール】

#### ①LOD2道路モデル生成機能

- 航空写真（オルソ）や道路ポリゴンデータ等からCityGML形式およびシェープファイル形式のLOD2道路モデルを作成します。

## 5. 利用技術

### 【LOD1道路モデル自動生成ツールの利用技術】

| 種別       | 名称   | バージョン | 内容 |
| --------- | --------|-------------|-----------------------------|
| ライブラリ | [Boost C++ Libraries](https://www.boost.org/) | 1.83.0 | 幾何計算ライブラリ |
|           | [concaveman-cpp](https://github.com/sadaszewski/concaveman-cpp) | 97d47b0 | 凹包ライブラリ |
|           | [shapelib](http://shapelib.maptools.org/) | 1.5.0 | シェープファイルライブラリ |

### 【LOD2道路モデル自動生成ツールの利用技術】

| 種別       | 名称                   | バージョン             | 説明                      |
| ---------- | ------------------    | ---------------------- | ------------------------- |
| ライブラリ  | tqdm MIT License      | 4.65.0 | プログレスバーの表示 |
|            | shapely               | 2.0.1 | 幾何計算 |
|            | numpy                 | 1.25.0 | 数値計算 |
|            | Pillow                | 10.0.0 | 画像の読み書き |
|            | PyYAML                | 6.0.1 | yamlファイルの読み書き |
|            | pyproj                | 3.6.0 | 座標系の変換 |
|            | pyshp                 | 2.3.1 | シェープファイルの読み書き |
|            | lxml                  | 4.9.3 | XMLファイルの読み書き |
|            | torch                 | 2.0.1 | 機械学習 |
|            | torchvision           | 0.15.2 | 機械学習 |
|            | lightning             | 2.0.6 | 機械学習 |
|            | opencv-python         | 4.7.0.72 | 画像の読み書き、画像処理 |
|            | opencv-contrib-python | 4.8.0.74 | 画像処理 |
|            | networkx              | 3.1 | グラフ構造の管理 |
|            | shapelysmooth         | 0.1.1 | 幾何のスムージング処理 |
|            | geopandas             | 0.13.2 | シェープファイルの書き出し |
|            | sortedcontainers      | 2.4.0 | ソート済みコレクションの管理 |
|            | openmim               | 0.3.9 | ライブラリの管理 |
|            | mmcv                  | 2.0.1 | 機械学習 |
|            | mmsegmentation        | 1.1.1 | 機械学習 |
|            | mmdet                 | 3.1.0 | 機械学習 |

## 6. 動作環境 <!-- 動作環境についての仕様を記載ください。 -->

### 【LOD1道路モデル自動生成ツールの動作環境】

| 項目               | 最小動作環境               | 推奨動作環境                   |
| ------------------ | ------------------------- | ------------------------------ |
| OS                 | Microsoft Windows 10 または 11 | 同左 |
| CPU                | Intel Core i7以上 | 同左 |
| メモリ             | 16GB以上 | 32GB以上 |
| HDD空き容量        | 1GB以上 | 5GB以上 |
| ネットワーク       | 不要 | 同左 |

### 【LOD2道路モデル自動生成ツールの動作環境】

| 項目               | 推奨動作環境               |
| ------------------ | ------------------------- |
| OS                 | Microsoft Windows 10 または 11 |
| CPU                | Intel Core i7以上 |
| メモリ             | 16GB以上 |
| GPU                | NVIDIA RTX 5000以上 |
| メモリ             | 16GB以上 |
| ネットワーク       | 不要 |

## 7. 本リポジトリのフォルダ構成 <!-- 本GitHub上のソースファイルの構成を記載ください。 -->

### 【LOD1道路モデル自動生成ツールのフォルダ構成】

| フォルダ名 |　詳細 |
|-|-|
| lod1/src/EXE/AutoCreateLod1Road | 道路LOD1モデル生成処理 |
| lod1/src/EXE/ConvertShapeToCityGML | CityGML変換処理 |
| lod1/src/LIB/CommonUtil | 道路LOD1モデル生成処理とCityGML変換処理の共有ライブラリ |
| lod1/src/LIB/concaveman-cpp | 凹包ライブラリ |
| lod1/src/PARAM | サンプルパラメータファイル |

### 【LOD2道路モデル自動生成ツールのフォルダ構成】

| フォルダ名 |　詳細 |
|-|-|
| lod2/src | 道路LOD2モデル生成処理 |
| lod2/src/src/steps | 道路LOD2モデル生成実処理 |
| lod2/src/src/tools | 処理ライブラリ |
| lod2/src/src/util | ログ機能処理 |

## 8. ライセンス <!-- 変更せず、そのまま使うこと。 -->

- ソースコード及び関連ドキュメントの著作権は国土交通省に帰属します。
- 本ドキュメントは[Project PLATEAUのサイトポリシー](https://www.mlit.go.jp/plateau/site-policy/)（CCBY4.0及び政府標準利用規約2.0）に従い提供されています。

## 9. 注意事項 <!-- 変更せず、そのまま使うこと。 -->

- 本リポジトリは参考資料として提供しているものです。動作保証は行っていません。
- 本リポジトリについては予告なく変更又は削除をする可能性があります。
- 本リポジトリの利用により生じた損失及び損害等について、国土交通省はいかなる責任も負わないものとします。

## 10. 参考資料 <!-- 技術検証レポートのURLはアクセンチュアにて記載します。 -->

- 技術検証レポート: https://www.mlit.go.jp/plateau/file/libraries/doc/plateau_tech_doc_0030_ver01.pdf
- PLATEAU WebサイトのUse caseページ「xxx」: https://www.mlit.go.jp/plateau/use-case/uc22-013/
